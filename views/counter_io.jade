#header
  h1 mu:sync

#main-content-box
  h1#counter

script(type='text/javascript')

  var serverTime = 0;
  var localTime = 0;
  var timeDiff = 0;
  var steps = #{steps};

  $(document).ready(function() {
    var socket = new io.Socket();

    receiveTime = function(time) {
      timeDiff = ((new Date).getTime() - localTime) / 2;
      console.log(timeDiff);
      serverTime = time + timeDiff;
    };

    socket.on('connect', function(){
      localTime = (new Date).getTime();
      socket.send();
    })

    socket.on('message', function(data){
      receiveTime(parseInt(data));
    })

    socket.connect();

    increment = function() {
      serverTime += steps;
      $("#counter").html('' + (serverTime / steps) + ' + ' + timeDiff);
    }
    setInterval(increment, steps);
  });

